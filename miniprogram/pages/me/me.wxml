<block wx:if="{{userInfo==null}}">
  <!-- 显示手机号快捷登录和其他手机号登录 -->
  <view class="container1">
    <view class="main">
      <view class="icon-view">
        <!-- 应用图标 -->
      </view>
    </view>
    <van-cell-group title="完善资料">
      <van-cell title="昵称">
        <input type="nickname" class="nickname-input" placeholder="请输入昵称" bindblur="onNicknameChange" bindinput="onNicknameChange" value="{{nickName}}" />
      </van-cell>
      <van-cell>
        <button type="warn" open-type="chooseAvatar" bindchooseavatar="getAvatar">授权登录</button>
      </van-cell>
    </van-cell-group>

    <!-- 用户协议同意 -->
    <view class="agreement-container">
      <checkbox class="checkbox" checked="{{agreed}}" bindtap="handleAgreeChange"></checkbox>
      <text class="agreement-text">我已阅读并同意</text>
      <navigator url="" class="agreement-link">《用户协议》</navigator>
    </view>
  </view>


</block>
<block wx:else>
  <view class="container profile-container">
    <!-- Header Card -->
    <view class="header-card">
      <view class="user-info">
        <van-image width="120rpx" height="120rpx" src="{{avatarUrl}}" round fit="cover" custom-class="avatar-shadow" />
        <view class="text-info">
          <view class="user-name">{{userInfo.name}}</view>
          <view class="user-id" bindtap="handleCopyID">ID: {{userInfo.uid || '221526'}}</view>
        </view>
      </view>
    </view>

    <!-- Stats Bar -->
    <view class="vip-bar">
      <view class="vip-item">
        <van-icon name="medal-o" color="#a38b5e" size="40rpx" />
        <text class="vip-label">信用分</text>
        <text class="vip-value">{{userInfo.score || 0}}</text>
      </view>
    </view>

    <!-- Wallet Card -->
    <view class="wallet-card">
      <view class="card-header">
        <text class="card-title">我的钱包</text>
      </view>
      <view class="wallet-content">
        <view class="wallet-sub-item" bindtap="handleGoToWallet">
          <view class="wallet-value">{{userInfo.balance || '0.00'}}</view>
          <view class="wallet-label">我的余额</view>
        </view>
        <view class="wallet-sub-item">
          <view class="wallet-value">0</view>
          <view class="wallet-label">优惠券</view>
        </view>
      </view>
    </view>

    <!-- Menu List -->
    <view class="menu-card">
      <van-cell-group inset>
        <van-cell 
          title="实名认证" 
          is-link 
          icon="manager-o" 
          value="{{userInfo.isVerified ? '已认证' : '未认证'}}" 
          url="/subpackages/auth/verification"
        />
        <van-cell title="地址管理" is-link icon="location-o" url="/subpackages/address/addressList" />
        <van-cell title="分享应用" is-link icon="share-o" />
        <van-cell title="清除缓存" is-link border="{{ false }}" bind:click="handleClearCache" icon="delete-o" />
      </van-cell-group>
    </view>

    <view class="logout-area">
      <van-button type="default" block round custom-style="color: #ee0a24;" bind:click="handleLogout">退出登录</van-button>
    </view>

  </view>
</block>